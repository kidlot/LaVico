<style>
    .checkbox .icons .first-icon, .radio .icons .first-icon, .checkbox .icons .second-icon, .radio .icons .second-icon {
        background-color: #E7E7E7;
    }
</style>
<div name="getMember" class="maginTop20">
    <div>
        <input type="hidden" name="_id" value="{@_id}">
        <div style="margin-left: 17px; height: 30px;">
            <a href="/lavico/answerQuestion/statistics/statistics_true:exportXsl?_id={@_id}" class="btn btn-xs btn-primary mhm pull-left">>全部导出</a>
            <a href="javascript:;" class="btn btn-xs btn-primary mhm pull-left" style="display: none"  onclick="sa()">开启</a>
        </div>
    </div>

    <table class="table table-hover" id="tagList">
            <tr>
                <th style="width: 30px;">
                    <input type="checkbox" onclick="CheckAll('selectAll',this)">
                </th>
                <th class="width50">时间</th>
                <th class="width50">姓名</th>
                <th class="width50">性别</th>
                <th class="width50">年龄</th>
                <th class="width50">城市</th>
                <th class="width50">获得礼券</th>
                <th class="width50">获得标签</th>
                <th class="width50">奖励积分</th>
            </tr>
            <foreach for="@data" var="onef">
                <tr>
                    <td style="width: 30px;">
                        <input type="checkbox" name="is_s" _id="{@onef.name}" >
                    </td>
                    <td class="width50">{@onef.createTime}</td>
                    <td class="width50"> {@onef.realname}</td>
                    <td class="width50">{@onef.gender}</td>
                    <td class="width50">{@onef.birthday}</td>
                    <td class="width50">{@onef.city}</td>
                    <td class="width50">{@onef.getGift}</td>
                    <td class="width50">{@onef.getLabel}</td>
                    <td class="width50">{@onef.compScore}</td>
                </tr>
            </foreach>
    </table>
    <div style="margin-left: 17px;">
        <include file="welab/templates/paginator.html" model="@page" model.url="/lavico/answerQuestion/statistics/statistics_true:finishPeople?_id={@_id}&finishCount={@finishCount}&totalPop={@totalPop}&page=%pagenum%" />
    </div>
</div>
<script>
    function CheckAll(value,obj)  {
        var num = document.getElementsByName("is_s");
        for(var i=0;i<num.length;i++){
            if(num[i].type == "checkbox"){
                var e = num[i];
                if (value=="selectAll"){
                    e.checked=obj.checked
                }else{
                    e.checked=!e.checked;
                }
            }
        }
    }

    function getReplyList(){
        var aList = [];
        $("#tagList").find("tr").each(function(i,o){
            var _oInput = jQuery(o).find("td:eq(0)").find("input")
            var _id = _oInput.attr("userid");

            if( _id && _oInput[0].checked){
                aList.push(_id);
            }
        })

        if( aList.length == 0){
            $.globalMessenger().post({
                message: '请选择至少一条数据',
                type: 'error',
                showCloseButton: true})
            return ;
        }else{
            return aList;
        }
    }

    function sa(){
        oLinkOptions = {} ;
        oLinkOptions.data = [];
        oLinkOptions.data.push({name:"store",value:getReplyList().join(",")});
        oLinkOptions.type = "POST";
        oLinkOptions.url = "/jinqiao/activity/index:Close";
        $.request(oLinkOptions,function(err,nut){
            if(err) throw err ;
            nut.msgqueue.popup() ;
            $.controller("/jinqiao/activity/index",null,"lazy");
        }) ;
        return false;
    }
</script>
