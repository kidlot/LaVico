<label>姓名</label><input disabled="true"　readOnly="true" id="realname" name="realname" type="text" value='{@realname}' /><br/>
<label>性别</label><input disabled="true"　readOnly="true" id="gender" name="gender" type="text" value="{@gender}"/><br/>
<lable>生日</lable><input disabled="true"　readOnly="true" id="birthday_year" name="birthday_year" type="text" value="{@birthday_year}"/><input disabled="true"　readOnly="true" id="birthday_month" name="birthday_month" type="text" value="{@birthday_month}"/><input disabled="true"　readOnly="true" id="birthday_date" name="birthday_date" type="text" value="{@birthday_date}"/><br/>


<lable>手机号码</lable><input disabled="true"　readOnly="true" id="mobile" name="mobile" type="text" value="{@mobile}"/><br/>
<lable>电子邮件</lable><input id="email" name="email" type="text" value="{@email}"/><br/>
<lable>行业</lable><input id="profession" name="profession" type="text" value="{@profession}"/><br/>
<lable>所属省份</lable><input id="province" name="province" name="province" type="text" value="{@province}"/><br/>
<lable>所属城市</lable><input id="city"  name="city" name="city" type="text" value="{@city}"/><br/>
<lable>具体地址</lable><input id="address" name="address" type="text" value="{@address}"/><br/>
<lable>喜好款式</lable><input id="favoriteStyle" name="favoriteStyle" type="text" value="{@favoriteStyle}"/><br/>
<lable>喜好颜色</lable><input id="favoriteColor" name="favoriteColor" type="text" value="{@favoriteColor}"/><br/>
<input id='submit' name='submit' type="button" value="提交审核">

submitInfo:{
layout:null,
view:null,
process:function(seed,nut){

this.step(function(){
data_request = {
openid:wxid,
MOBILE_TELEPHONE_NO:userTel,
MEM_OLDCARD_NO:userCardNumber,
MEM_PSN_CNAME:userName
};
middleware.request( "Member/Bind",
data_request,
this.hold(function(err,doc){
var dataJson = JSON.parse(doc);
/*记录用户行为*/
helper.db.coll("welab/feeds").insert(
{
'createTime':new Date().getTime(),
'wxid':seed.wxid,
'action':"bind",
'request':data_request,
'reponse':dataJson
},
function(err,req_doc){
err&&console.log(req_doc);
}
);
data_doc = doc;
return doc;
}));
});

this.step(function(doc){
var dataJson = JSON.parse(data_doc);
if(dataJson.success == true){
middleware.request( "Member/Level/"+dataJson.MEMBER_ID,{
}
,then.hold(function(err,req_doc){
var member_level = eval('('+req_doc+')');
if(member_level.level == '01'){
type = 1;
}else if(member_level.level == '02'){
type = 2;
}else if(member_level.level == '03'){
type = 3;
}else{
type = 0;
}
}));
}else{
this.res.writeHead(200, { 'Content-Type': 'application/json' });
this.res.write('{"success":false,"error":"MEMBER_ID_level_no_found"}');
this.res.end();
this.terminate();
}
return doc;
});

this.step(function(doc){
var dataJson = JSON.parse(data_doc);
if(dataJson.success == true){
then.req.session.id_code = '';
var _tempData = {
'realname':userName,
'mobile':userTel,
'isRegister':true,
'registerTime':new Date().getTime(),
'HaiLanMemberInfo':{
'memberID':dataJson.MEMBER_ID,
'action':'bind',
'lastModified':new Date().getTime(),
'type':type
}
};
console.log('_tempData:');
console.log(_tempData);
helper.db.coll('welab/customers').update({wechatid:wxid},{
$set:{
'realname':userName,
'mobile':userTel,
'isRegister':true,
'registerTime':new Date().getTime(),
'HaiLanMemberInfo':{
'memberID':dataJson.MEMBER_ID,
'action':'bind',
'lastModified':new Date().getTime(),
'type':type
}
}
},function(err,doc){
err&&console.log(doc);
});
}
then.res.writeHead(200, { 'Content-Type': 'application/json' });
then.res.write(data_doc);
then.res.end();
then.terminate();
});
}
},